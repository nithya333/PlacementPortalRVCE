{% extends "base.html" %}
{% load static %}
{% block body_here %}
<!-- Main Layout -->
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #dae8f1;
}

.nav-link.active {
  background-color: #3f7fa6; /* Replace with your desired color */
  color: white; /* Adjust text color for better contrast */
}

.nav-link.active:hover {
  background-color: #7eafce; /* Slightly darker shade for hover */
}

.student-icon {
  width: 60px;
  height: 60px;
  border-radius: 60%; /* Makes it circular */
  object-fit: cover; /* Ensures proper scaling of image */
}
.welcome-text {
  font-size: 1.2rem;
  font-weight: bold;
  color: #23465c;
  text-decoration: none;
}
.student-name {
  color: #007bff; /* Highlighted color for student name */
}

.container {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  justify-content: center;
  padding: 20px;
}

/* Card Styles */
.card {
  background: #fff;
  border-radius: 10px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  width: 300px;
  padding: 20px;
  text-align: left;
  transition: transform 0.2s, box-shadow 0.2s;
}

.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
}

.card h3 {
  font-size: 1.2rem;
  margin-bottom: 20px;
  color: #333;
}


/* Timeline Styles */
    .timeline {
        position: relative;

        border-left: 3px solid #e0e0e0;
    }
    .timeline p, span{
        padding-left: 10px;
    }

    .timeline-item {
        position: relative;
        margin-bottom: 15px;
    }

    .timeline-item:last-child {
        margin-bottom: 0;
    }

    .timeline-item::before {
        content: '';
        position: absolute;
        left: -11px;
        top: 0;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background-color: #e0e0e0;
        border: 2px solid #fff;
        z-index: 2;
    }

    .timeline-item.completed::before {
        background-color: #4caf50;
    }

    .timeline-item.rejected::before {
      background-color: #ff3333;
    }

    .timeline-item.rejected_progress::before {
      background-color: #ffdd99;
    }
    

    .timeline-item span {
        display: inline-block;
        margin-left: 10px;
        font-size: 0.9rem;
        color: #555;
    }

    .timeline-item.completed span {
        color: #333;
        font-weight: bold;
    }


/* Button Styles */
.btn {
  background-color: #3f7fa6;
  color: #fff;
  border: none;
  border-radius: 5px;
  padding: 10px 20px;
  font-size: 1rem;
  cursor: pointer;
  transition: background-color 0.2s;
  display: block;
  margin: 0 auto;
  text-align: center;
}

.btn:hover {
  background-color: #2a556f;
  color: white;
}
</style>
    <div class="d-flex">
        <div class="d-flex flex-column flex-shrink-0 p-3 bg-light" style="width: 20%;">
            <ul class="nav nav-pills flex-column mb-auto">
              <li class="nav-item">
                <a href="#" class="welcome-text" aria-current="page">
                  <img 
                  src="https://img.freepik.com/premium-vector/boy-student-graduate-cap-icon-sign-logo-color-isolated-image-circle-isolated-vector-illustration_619989-1110.jpg" 
                  alt="Student Icon" 
                    class="student-icon"
                    >
                    {{ request.session.u_name }}
                  </a>
                </li>
                <hr>
              <li class="nav-item">
                <a href="/student/home" class="nav-link link-dark" >
                    <i class="bi bi-house-door me-2"></i>
                    Home
                </a>
              </li>
              <li>
                <a href="/student/profile" class="nav-link link-dark">
                    <i class="bi bi-person me-2"></i>
                  Profile
                </a>
              </li>
              <li>
                <a href="/student/applied" class="nav-link active"  style = "background-color: #3f7fa6; ">
                    <i class="bi bi-grid-fill me-2"></i>
                  Applied Jobs
                </a>
              </li>
              <li>
                <a href="/student/new" class="nav-link link-dark">
                    <i class="bi bi-megaphone me-2"></i>
                  New Offers
                </a>
              </li>
              <li>
                <a href="/student/fetchpdf/{{ request.session.u_id|default:'' }}" class="nav-link link-dark">
                    <i class="bi bi-download me-2"></i>
                  Export Resume
                </a>
              </li>
              {% comment %} <li>
                <a href="#" class="nav-link link-dark">
                    <i class="bi bi-peoplecircle me-2"></i>
                  Customers
                </a>
              </li> {% endcomment %}
            </ul>
            <hr>
          </div>
    <!-- Main Content -->
    <div class="main-content flex-grow-1">
      <div class="container">
        <!-- Card 1 -->
        {% comment %} [{'_id': ObjectId('67791dea9fd67f9b094e0983'), 'job_title': 'Testing', 'job_type': 'full_time', 'job_duration': 'Full time', 'job_desc': 'Testing appl', 'job_domain': 'software_development', 'job_salary': 9.25, 'cgpaMinCriteria': 7.5, 'cgpaMaxCriteria': 10, 'degreeCriteria': 'pg', 'job_locations': ['Bengaluru'], 'deptsCriteria': ['MCA', 'MCN', 'MCS'], 'yearOfPassingCriteria': [2026, 2027], 'skillsPreferences': ['Web dev', 'app dev'], 'job_enrolledDate': '2025-01-03 18:51:32', 'job_pptDate': '2025-01-05', 'job_oaDate': '2025-01-08', 'job_interviewDate': '2025-01-14', 'job_status': 1, 'job_stage': 1, 'job_companyId': 'C001', 'job_companyName': 'Google', 'job_numStudents': 2, 'job_lastUpdated': '2025-01-03 18:51:32', 'appl_id': '67791dea9fd67f9b094e0982', 'appl_date': '2025-01-04 17:09:22', 'appl_student_id': '1RV24MCN016', 'appl_job_id': '6777e45c7a803a745491da5f', 'appl_status': 0, 'appl_stage': 1, 'appl_lastUpdated': '2025-01-04 17:09:22'}] {% endcomment %}
        {% for appl in applied %}
        <div class="card">
            <h3>Recruiter: {{ appl.job_companyName }}</h3>
            <div class="timeline">
              {% if appl.job_stage >= 1 and appl.appl_stage == 0 %}
              <div class="timeline-item rejected">
              {% elif appl.job_stage >= 1 and appl.appl_stage < 1 %}
              <div class="timeline-item rejected_progress">
              {% elif appl.job_stage >= 1 and appl.appl_stage >= 1 %}
              <div class="timeline-item completed">
              {% else %}
                <div class="timeline-item">
              {% endif %}
                    <span>Registered</span> 
                </div>

                {% if appl.job_stage >= 2 and appl.appl_stage == 1 %}
                <div class="timeline-item rejected">
                {% elif appl.job_stage >= 2 and appl.appl_stage < 2 %}
              <div class="timeline-item rejected_progress">
              {% elif appl.job_stage >= 2 and appl.appl_stage >= 2 %}
              <div class="timeline-item completed">
              {% else %}
                <div class="timeline-item">
              {% endif %}
                    <span>Applications closed</span>
                </div>

                {% if appl.job_stage >= 3 and appl.appl_stage == 2 %}
                <div class="timeline-item rejected">
                {% elif appl.job_stage >= 3 and appl.appl_stage < 3 %}
              <div class="timeline-item rejected_progress">
              {% elif appl.job_stage >= 3 and appl.appl_stage >= 3 %}
              <div class="timeline-item completed">
              {% else %}
                <div class="timeline-item">
              {% endif %}
                    <span>Shortlisted at college level</span>
                </div>


                {% if appl.job_stage >= 4 and appl.appl_stage == 3 %}
                <div class="timeline-item rejected">
                {% elif appl.job_stage >= 4 and appl.appl_stage < 4 %}
              <div class="timeline-item rejected_progress">
              {% elif appl.job_stage >= 4 and appl.appl_stage >= 4 %}
              <div class="timeline-item completed">
              {% else %}
                <div class="timeline-item">
              {% endif %}
                    <span>PPT</span>
                </div>
                
                {% if appl.job_stage >= 5 and appl.appl_stage == 4 %}
                <div class="timeline-item rejected">
                {% elif appl.job_stage >= 5 and appl.appl_stage < 5 %}
              <div class="timeline-item rejected_progress">
              {% elif appl.job_stage >= 5 and appl.appl_stage >= 5 %}
              <div class="timeline-item completed">
              {% else %}
                <div class="timeline-item">
              {% endif %}
                  <span>OA</span>
              </div>

              {% if appl.job_stage >= 6 and appl.appl_stage == 5 %}
              <div class="timeline-item rejected">
              {% elif appl.job_stage >= 6 and appl.appl_stage < 6 %}
              <div class="timeline-item rejected_progress">
              {% elif appl.job_stage >= 6 and appl.appl_stage >= 6 %}
              <div class="timeline-item completed">
              {% else %}
                <div class="timeline-item">
              {% endif %}
                  <span>Interview</span>
              </div>

              {% if appl.job_stage >= 7 and appl.appl_stage == 6 %}
              <div class="timeline-item rejected">
              {% elif appl.job_stage >= 7 and appl.appl_stage < 7 %}
              <div class="timeline-item rejected_progress">
              {% elif appl.job_stage >= 7 and appl.appl_stage >= 7 %}
              <div class="timeline-item completed">
              {% else %}
                <div class="timeline-item">
              {% endif %}
                <span>Recruited</span>
              </div>
            </div>
            <br>
            <a href="/student/applied/vmore/{{ appl.appl_job_id }}" class="card-link"><button class="btn">View More</button></a>
            <br></div>
          {% endfor %}

          {% comment %} {% for appl in applied %}
            <div class="card">
              <h3>Recruiter: {{ appl.job_companyName }}</h3>
              <div class="timeline">
                {% for stage, label, prev_stage in [
                    (1, "Registered", 0),
                    (2, "Applications closed", 1),
                    (3, "Shortlisted at college level", 2),
                    (4, "PPT", 3),
                    (5, "OA", 4),
                    (6, "Interview", 5),
                    (7, "Recruited", 6)
                  ]
                %}
                  {% if appl.job_stage >= stage %}
                    <div class="timeline-item rejected_progress">
                  {% endif %}
                  {% if appl.appl_stage >= stage %}
                    <div class="timeline-item completed">
                  {% elif appl.job_stage >= stage and appl.appl_stage == prev_stage %}
                    <div class="timeline-item rejected">
                  {% else %}
                    <div class="timeline-item">
                  {% endif %}
                    <span>{{ label }}</span>
                  </div>
                {% endfor %}
              </div>
              <br>
              <a href="/student/applied/vmore/{{ appl.appl_job_id }}" class="card-link">
                <button class="btn">View More</button>
              </a>
              <br>
            </div>
        {% endfor %} {% endcomment %}
            
        {% comment %} <div class="card">
            <h3>Company Name: ABC Corp</h3>
            <div class="timeline">
                <div class="timeline-item completed">
                    <span>Accepted at CG</span>
                </div>
                <div class="timeline-item completed">
                    <span>Round 1</span>
                </div>
                <div class="timeline-item">
                    <span>Round 2</span>
                </div>
                <div class="timeline-item">
                    <span>Accepted</span>
                </div>
            </div>
            <br>
            <a href="/student/applied/vmore/154" class="card-link"><button class="btn">View More</button></a>

        </div> {% endcomment %}

        
      </div>
    </div>

{% endblock %}